[
    {
        "rule": "Additional options may be allowed, required, or not allowed, depending on the DHCP message type.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The protocol defines that the key will be (IP-subnet-number, hardware-address) unless the client explicitly supplies an identifier using the 'client identifier' option.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The servers SHOULD unicast the DHCPACK reply to the address given in the 'ciaddr' field of the DHCPINFORM message.",
        "req_type": "DHCPINFORM",
        "req_fields": [
            "ciaddr"
        ],
        "res_type": "DHCPACK",
        "res_fields": []
    },
    {
        "rule": "The first four octets of the 'options' field of the DHCP message contain the (decimal) values 99, 130, 83 and 99, respectively, which is the same magic cookie as defined in RFC 1497 [17].",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Servers receiving a DHCPINFORM message construct a DHCPACK message with any local configuration parameters appropriate for the client without allocating a new address, checking for an existing binding, filling in 'yiaddr' or including lease time parameters.",
        "req_type": "DHCPINFORM",
        "req_fields": [],
        "res_type": "DHCPACK",
        "res_fields": [
            "yiaddr"
        ]
    },
    {
        "rule": "For example, the key might be the pair (IP-subnet-number, hardware- address) (note that the \"hardware-address\" should be typed by the type of hardware to accommodate possible duplication of hardware addresses resulting from bit-ordering problems in a mixed-media, bridged network) allowing for serial or concurrent reuse of a hardware address on different subnets, and for hardware addresses that may not be globally unique.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the client includes a list of parameters in a DHCPDISCOVER message, the client MUST include that list in any subsequent DHCPREQUEST messages.",
        "req_type": "DHCPDISCOVER, DHCPREQUEST",
        "req_fields": [
            "parameter list"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The client SHOULD include the 'maximum DHCP message size' option to let the server know how large the server may make its DHCP messages.",
        "req_type": "DHCPDISCOVER or DHCPREQUEST",
        "req_fields": [
            "maximum DHCP message size"
        ],
        "res_type": "DHCPOFFER or DHCPACK",
        "res_fields": []
    },
    {
        "rule": "In this case, two additional options flags (which must appear in the 'options' field of the message) indicate that the 'file' and 'sname' fields are to be used for options.",
        "req_type": "",
        "req_fields": [
            "options",
            "file",
            "sname"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Other options representing \"hints\" at configuration parameters are allowed in a DHCPDISCOVER or DHCPREQUEST message.",
        "req_type": "DHCPDISCOVER, DHCPREQUEST",
        "req_fields": [
            "options"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The client may include the 'requested IP address' option to suggest that a particular IP address be assigned, and may include the 'IP address lease time' option to suggest the lease time the client would like.",
        "req_type": "DHCPDISCOVER",
        "req_fields": [
            "requested IP address",
            "IP address lease time"
        ],
        "res_type": "DHCPOFFER",
        "res_fields": []
    },
    {
        "rule": "The 'requested IP address' option is to be filled in only in a DHCPREQUEST message when the client is verifying network parameters obtained previously.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "requested IP address"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If a server receives a DHCPREQUEST message with an invalid 'requested IP address', the server SHOULD respond to the client with a DHCPNAK message and may choose to report the problem to the system administrator.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "requested IP address"
        ],
        "res_type": "DHCPNAK",
        "res_fields": []
    },
    {
        "rule": "The server MUST NOT send a lease expiration time to the client and SHOULD NOT fill in 'yiaddr'.",
        "req_type": "DHCPINFORM",
        "req_fields": [],
        "res_type": "DHCPACK",
        "res_fields": [
            "yiaddr",
            "lease expiration time"
        ]
    },
    {
        "rule": "The server responds to a DHCPINFORM message by sending a DHCPACK message directly to the address given in the 'ciaddr' field of the DHCPINFORM message.",
        "req_type": "DHCPINFORM",
        "req_fields": [
            "ciaddr"
        ],
        "res_type": "DHCPACK",
        "res_fields": []
    },
    {
        "rule": "If the client supplies a 'client identifier', the client MUST use the same 'client identifier' in all subsequent messages, and the server MUST use that identifier to identify the client.",
        "req_type": "",
        "req_fields": [
            "client identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "In some environments, a DHCP server will have to consider the values of the vendor class options included in DHCPDISCOVER or DHCPREQUEST messages when determining the correct parameters for a particular client.",
        "req_type": "DHCPDISCOVER or DHCPREQUEST",
        "req_fields": [
            "vendor class options"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Table 4 shows the differences between messages from clients in various states: INIT-REBOOT uses broadcast and MUST include requested-ip but MUST NOT include server-ip, with ciaddr zero; SELECTING uses broadcast and MUST include both server-ip and requested-ip, with ciaddr zero; RENEWING uses unicast and MUST NOT include server-ip or requested-ip, with ciaddr as the IP address; REBINDING uses broadcast and MUST NOT include server-ip or requested-ip, with ciaddr as the IP address.",
        "req_type": "DHCPDISCOVER (for INIT-REBOOT and SELECTING states), DHCPREQUEST (for RENEWING and REBINDING states)",
        "req_fields": [
            "requested-ip",
            "server-ip",
            "ciaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the client does not provide a 'client identifier' option, the server MUST use the contents of the 'chaddr' field to identify the client.",
        "req_type": "",
        "req_fields": [
            "client identifier",
            "chaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The client MUST NOT include a 'server identifier' in the DHCPREQUEST message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "server identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The client MUST insert its known network address as a 'requested IP address' option in the DHCPREQUEST message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "requested IP address"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The client records the lease expiration time as the sum of the time at which the DHCPREQUEST message was sent and the duration of the lease from the DHCPACK message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [],
        "res_type": "DHCPACK",
        "res_fields": [
            "lease duration"
        ]
    },
    {
        "rule": "Once a DHCPACK message with an 'xid' field matching that in the client's DHCPREQUEST message arrives from any server, the client is initialized and moves to BOUND state.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "xid"
        ],
        "res_type": "DHCPACK",
        "res_fields": [
            "xid"
        ]
    },
    {
        "rule": "As the client has not received its network address, the client MUST NOT fill in the 'ciaddr' field.",
        "req_type": "",
        "req_fields": [
            "ciaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Once a DHCPACK message with an 'xid' field matching that in the client's DHCPINFORM message arrives from any server, the client is initialized.",
        "req_type": "DHCPINFORM",
        "req_fields": [
            "xid"
        ],
        "res_type": "DHCPACK",
        "res_fields": [
            "xid"
        ]
    },
    {
        "rule": "If the client used a 'client identifier' to obtain its address, the client MUST use the same 'client identifier' in the DHCPREQUEST message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "client identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If 'giaddr' is 0x0 in the DHCPREQUEST message, the client is on the same subnet as the server.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "giaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Otherwise, the server MUST send the DHCPNAK message to the IP address of the BOOTP relay agent, as recorded in 'giaddr'.",
        "req_type": "",
        "req_fields": [],
        "res_type": "DHCPNAK",
        "res_fields": [
            "giaddr"
        ]
    },
    {
        "rule": "The specific lease is implicitly identified by the 'client identifier' or 'chaddr' and the network address.",
        "req_type": "",
        "req_fields": [
            "client identifier",
            "chaddr",
            "network address"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the client detects that the IP address in the DHCPACK message is already in use, the client MUST send a DHCPDECLINE message to the server and restarts the configuration process by requesting a new network address.",
        "req_type": "DHCPDECLINE",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The client identifies the lease to be released with its 'client identifier', or 'chaddr' and network address in the DHCPRELEASE message.",
        "req_type": "DHCPRELEASE",
        "req_fields": [
            "client identifier",
            "chaddr",
            "network address"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The client MUST NOT include a 'server identifier' in the DHCPREQUEST message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "server identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Any DHCPACK messages that arrive with an 'xid' that does not match the 'xid' of the client's DHCPREQUEST message are silently discarded.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "xid"
        ],
        "res_type": "DHCPACK",
        "res_fields": [
            "xid"
        ]
    },
    {
        "rule": "The client MUST NOT include a 'server identifier' in the DHCPREQUEST message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "server identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "When the client receives a DHCPACK from the server, the client computes the lease expiration time as the sum of the time at which the client sent the DHCPREQUEST message and the duration of the lease in the DHCPACK message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [],
        "res_type": "DHCPACK",
        "res_fields": [
            "duration of the lease"
        ]
    },
    {
        "rule": "The client MUST include its hardware address in the 'chaddr' field, if necessary for delivery of DHCP reply messages.",
        "req_type": "DHCPDISCOVER",
        "req_fields": [
            "chaddr"
        ],
        "res_type": "DHCPOFFER",
        "res_fields": []
    },
    {
        "rule": "The client MAY suggest a network address and/or lease time by including the 'requested IP address' and 'IP address lease time' options.",
        "req_type": "DHCPDISCOVER",
        "req_fields": [
            "requested IP address",
            "IP address lease time"
        ],
        "res_type": "DHCPOFFER",
        "res_fields": []
    },
    {
        "rule": "The client MAY include a different unique identifier in the 'client identifier' option, as discussed in section 4.2.",
        "req_type": "DHCPDISCOVER",
        "req_fields": [
            "client identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "In both RENEWING and REBINDING states, if the client receives no response to its DHCPREQUEST message, the client SHOULD wait one-half of the remaining time until T2 (in RENEWING state) and one-half of the remaining lease time (in REBINDING state), down to a minimum of 60 seconds, before retransmitting the DHCPREQUEST message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the client included a list of requested parameters in a DHCPDISCOVER message, the client MUST include that list in all subsequent messages.",
        "req_type": "DHCPDISCOVER",
        "req_fields": [
            "parameter_request_list"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Any arriving DHCPACK messages must be silently discarded.",
        "req_type": "",
        "req_fields": [],
        "res_type": "DHCPACK",
        "res_fields": []
    },
    {
        "rule": "If the 'xid' of an arriving DHCPOFFER message does not match the 'xid' of the most recent DHCPDISCOVER message, the DHCPOFFER message must be silently discarded.",
        "req_type": "DHCPDISCOVER",
        "req_fields": [
            "xid"
        ],
        "res_type": "DHCPOFFER",
        "res_fields": [
            "xid"
        ]
    },
    {
        "rule": "If the parameters are acceptable, the client records the address of the server that supplied the parameters from the 'server identifier' field and sends that address in the 'server identifier' field of a DHCPREQUEST broadcast message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "server identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The client collects DHCPOFFER messages over a period of time, selects one DHCPOFFER message from the (possibly many) incoming DHCPOFFER messages (e.g., the first DHCPOFFER message or the DHCPOFFER message from the previously used server) and extracts the server address from the 'server identifier' option in the DHCPOFFER message.",
        "req_type": "",
        "req_fields": [],
        "res_type": "DHCPOFFER",
        "res_fields": [
            "server identifier"
        ]
    },
    {
        "rule": "The DHCPREQUEST message contains the same 'xid' as the DHCPOFFER message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "xid"
        ],
        "res_type": "DHCPOFFER",
        "res_fields": [
            "xid"
        ]
    },
    {
        "rule": "When broadcasting an ARP request for the suggested address, the client must fill in its own hardware address as the sender's hardware address, and 0 as the sender's IP address, to avoid confusing ARP caches in other hosts on the same subnet.",
        "req_type": "ARP Request",
        "req_fields": [
            "sender hardware address",
            "sender IP address"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the network address appears to be in use, the client MUST send a DHCPDECLINE message to the server.",
        "req_type": "DHCPDECLINE",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "A DHCPREQUEST message may come from a client responding to a DHCPOFFER message from a server, from a client verifying a previously allocated IP address or from a client extending the lease on a network address.",
        "req_type": "DHCPREQUEST",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the DHCPREQUEST message contains a 'server identifier' option, the message is in response to a DHCPOFFER message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "server identifier"
        ],
        "res_type": "DHCPOFFER",
        "res_fields": []
    },
    {
        "rule": "If the client uses a 'client identifier' in a DHCPREQUEST message, the client MUST use that same 'client identifier' in all subsequent messages.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "client identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the client included a list of requested parameters in a DHCPDISCOVER message, the client MUST include that list in all subsequent messages.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "parameter_request_list"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Any configuration parameters in the DHCPACK message SHOULD NOT conflict with those in the earlier DHCPOFFER message to which the client is responding.",
        "req_type": "DHCPREQUEST",
        "req_fields": [],
        "res_type": "DHCPACK",
        "res_fields": [
            "configuration parameters"
        ]
    },
    {
        "rule": "The client SHOULD use the parameters in the DHCPACK message for configuration.",
        "req_type": "DHCPREQUEST",
        "req_fields": [],
        "res_type": "DHCPACK",
        "res_fields": [
            "parameters"
        ]
    },
    {
        "rule": "'ciaddr' MUST be zero.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "ciaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Clients send DHCPREQUEST messages as follows: DHCPREQUEST generated during SELECTING state: The client inserts the address of the selected server in 'server identifier', 'ciaddr' MUST be zero, and 'requested IP address' MUST be filled in with the yiaddr value from the chosen DHCPOFFER.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "server identifier",
            "ciaddr",
            "requested IP address"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "DHCPREQUEST generated during INIT-REBOOT state: 'server identifier' MUST NOT be filled in, and the 'requested IP address' option MUST be filled in with the client's notion of its previously assigned address.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "server identifier",
            "requested IP address"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The server SHOULD send a DHCPNAK message to the client if the 'requested IP address' is incorrect or is on the wrong network.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "requested IP address"
        ],
        "res_type": "DHCPNAK",
        "res_fields": []
    },
    {
        "rule": "Determining whether a client in the INIT-REBOOT state is on the correct network is done by examining the contents of 'giaddr', the 'requested IP address' option, and a database lookup.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "giaddr",
            "requested IP address"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the DHCP server detects that the client is on the wrong network (i.e., the result of applying the local subnet mask or remote subnet mask if 'giaddr' is not zero to the 'requested IP address' option value does not match reality), then the server SHOULD send a DHCPNAK message to the client.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "requested IP address",
            "giaddr"
        ],
        "res_type": "DHCPNAK",
        "res_fields": []
    },
    {
        "rule": "If 'giaddr' is set in the DHCPREQUEST message, the client is on a different subnet.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "giaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If 'giaddr' is 0x0 in the DHCPREQUEST message, the client is on the same subnet as the server.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "giaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "DHCPREQUEST generated during RENEWING state: 'server identifier' MUST NOT be filled in, the 'requested IP address' option MUST NOT be filled in, and 'ciaddr' MUST be filled in with the client's IP address.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "server identifier",
            "requested IP address",
            "ciaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The server may choose not to extend the lease as a policy decision by the network administrator, but should return a DHCPACK message regardless.",
        "req_type": "DHCPREQUEST",
        "req_fields": [],
        "res_type": "DHCPACK",
        "res_fields": []
    },
    {
        "rule": "Because 'giaddr' is therefore not filled in, the DHCP server will trust the value in 'ciaddr', and use it when replying to the client.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "giaddr",
            "ciaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The DHCP server SHOULD check 'ciaddr' for correctness before replying to the DHCPREQUEST.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "ciaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Similarly, the tagged data items that were used inside the BOOTP \"vendor extensions\" field, which were formerly referred to as \"vendor extensions,\" are now termed simply \"options.\" DHCP defines a new 'client identifier' option that is used to pass an explicit client identifier to a DHCP server.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "DHCPREQUEST generated during REBINDING state: 'server identifier' MUST NOT be filled in, the 'requested IP address' option MUST NOT be filled in, and 'ciaddr' MUST be filled in with the client's IP address.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "server identifier",
            "requested IP address",
            "ciaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The 'client identifier' chosen by a DHCP client MUST be unique to that client within the subnet to which the client is attached.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The 'client identifier' is an opaque key, not to be interpreted by the server; for example, the 'client identifier' may contain a hardware address, identical to the contents of the 'chaddr' field, or it may contain another type of identifier, such as a DNS name.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "This change eliminates the overloading of the 'chaddr' field in BOOTP messages, where 'chaddr' is used both as a hardware address for transmission of BOOTP reply messages and as a client identifier.",
        "req_type": "BOOTP",
        "req_fields": [
            "chaddr"
        ],
        "res_type": "BOOTP reply",
        "res_fields": [
            "chaddr"
        ]
    },
    {
        "rule": "If the client uses a 'client identifier' in one message, it MUST use that same identifier in all subsequent messages, to ensure that all servers correctly identify the client.",
        "req_type": "any DHCP message from client",
        "req_fields": [
            "client identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "A DHCP server always returns its own address in the 'server identifier' option.",
        "req_type": "",
        "req_fields": [],
        "res_type": "DHCPOFFER, DHCPACK, DHCPNAK",
        "res_fields": [
            "server identifier"
        ]
    },
    {
        "rule": "htype 1 hardware address type, see ARP section in \"Assigned Numbers\" RFC; for example, '1' equals 10mb ethernet.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "chaddr 16 client hardware address.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The options field may be further extended into the 'file' and 'sname' fields.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "A DHCP client must be prepared to receive DHCP messages with an 'options' field of at least length 312 octets.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "While not required for correct operation of DHCP, the server SHOULD NOT reuse the selected network address before the client responds to the server's DHCPOFFER message.",
        "req_type": "DHCPDISCOVER",
        "req_fields": [],
        "res_type": "DHCPOFFER",
        "res_fields": []
    },
    {
        "rule": "Note that, in some network architectures (e.g., internets with more than one IP subnet assigned to a physical network segment), it may be the case that the DHCP client should be assigned an address from a different subnet than the address recorded in 'giaddr'.",
        "req_type": "DHCPDISCOVER",
        "req_fields": [
            "giaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The server inserts the 'xid' field from the DHCPDISCOVER message into the 'xid' field of the DHCPOFFER message and sends the DHCPOFFER message to the requesting client.",
        "req_type": "DHCPDISCOVER",
        "req_fields": [
            "xid"
        ],
        "res_type": "DHCPOFFER",
        "res_fields": [
            "xid"
        ]
    },
    {
        "rule": "If an address is available, the new address SHOULD be chosen as follows: the client's current address as recorded in the client's current binding, else the client's previous address as recorded in the client's (now expired or released) binding if that address is in the server's pool of available addresses and not already allocated, else the address requested in the 'Requested IP Address' option if that address is valid and not already allocated, else a new address allocated from the server's pool of available addresses; the address is selected based on the subnet from which the message was received (if 'giaddr' is 0) or on the address of the relay agent that forwarded the message ('giaddr' when not 0).",
        "req_type": "DHCPDISCOVER",
        "req_fields": [
            "Requested IP Address",
            "giaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The options area includes first a four-octet 'magic cookie' (which was described in section 3), followed by the options.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The 'server identifier' field is used both to identify a DHCP server in a DHCP message and as a destination address from clients to servers.",
        "req_type": "",
        "req_fields": [
            "server identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The server must also choose an expiration time for the lease, as follows: if the client has not requested a specific lease in the DHCPDISCOVER message and the client already has an assigned network address, the server returns the lease expiration time previously assigned to that address (note that the client must explicitly request a specific lease to extend the expiration time on a previously assigned address), else if the client has not requested a specific lease in the DHCPDISCOVER message and the client does not have an assigned network address, the server assigns a locally configured default lease time, else if the client has requested a specific lease in the DHCPDISCOVER message (regardless of whether the client has an assigned network address), the server may choose either to return the requested lease (if the lease is acceptable to local policy) or select another lease.",
        "req_type": "DHCPDISCOVER",
        "req_fields": [
            "requested lease time"
        ],
        "res_type": "DHCPOFFER",
        "res_fields": [
            "lease expiration time"
        ]
    },
    {
        "rule": "The server MUST also include: any parameters from the existing binding that differ from the Host Requirements Document defaults, any parameters specific to this client (as identified by the contents of 'chaddr' or 'client identifier' in the DHCPDISCOVER or DHCPREQUEST message), for example as configured by the network administrator, any parameters specific to this client's class (as identified by the contents of the 'vendor class identifier' option in the DHCPDISCOVER or DHCPREQUEST message), for example as configured by the network administrator; the parameters MUST be identified by an exact match between the client's vendor class identifiers and the client's classes identified in the server, and parameters with non-default values on the client's subnet.",
        "req_type": "DHCPDISCOVER, DHCPREQUEST",
        "req_fields": [
            "chaddr",
            "client identifier",
            "vendor class identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "To accommodate potentially incomplete network connectivity, a server MUST choose an address as a 'server identifier' that, to the best of the server's knowledge, is reachable from the client.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the server has received a message through a DHCP relay agent, the server SHOULD choose an address from the interface on which the message was received as the 'server identifier' (unless the server has other, better information on which to make its choice).",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "DHCP clients MUST use the IP address provided in the 'server identifier' option for any unicast requests to the DHCP server.",
        "req_type": "",
        "req_fields": [
            "server identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "For example, if the DHCP server and the DHCP client are connected to the same subnet (i.e., the 'giaddr' field in the message from the client is zero), the server SHOULD select the IP address the server is using for communication on that subnet as the 'server identifier'.",
        "req_type": "",
        "req_fields": [
            "giaddr"
        ],
        "res_type": "",
        "res_fields": [
            "server identifier"
        ]
    },
    {
        "rule": "If the 'giaddr' field is zero and the 'ciaddr' field is nonzero, then the server unicasts DHCPOFFER and DHCPACK messages to the address in 'ciaddr'.",
        "req_type": "",
        "req_fields": [
            "giaddr",
            "ciaddr"
        ],
        "res_type": "DHCPOFFER, DHCPACK",
        "res_fields": []
    },
    {
        "rule": "If 'giaddr' is zero and 'ciaddr' is zero, and the broadcast bit is set, then the server broadcasts DHCPOFFER and DHCPACK messages to 0xffffffff.",
        "req_type": "",
        "req_fields": [
            "giaddr",
            "ciaddr",
            "flags"
        ],
        "res_type": "DHCPOFFER, DHCPACK",
        "res_fields": []
    },
    {
        "rule": "If the broadcast bit is not set and 'giaddr' is zero and 'ciaddr' is zero, then the server unicasts DHCPOFFER and DHCPACK messages to the client's hardware address and 'yiaddr' address.",
        "req_type": "",
        "req_fields": [
            "broadcast bit",
            "giaddr",
            "ciaddr"
        ],
        "res_type": "DHCPOFFER, DHCPACK",
        "res_fields": [
            "client's hardware address",
            "yiaddr"
        ]
    },
    {
        "rule": "If the 'option overload' option is present in the 'options' field, the options in the 'options' field MUST be terminated by an 'end' option, and MAY contain one or more 'pad' options to fill the options field.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the options in a DHCP message extend into the 'sname' and 'file' fields, the 'option overload' option MUST appear in the 'options' field, with value 1, 2 or 3, as specified in RFC 1533.",
        "req_type": "",
        "req_fields": [
            "sname",
            "file",
            "options"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The options in the 'sname' and 'file' fields (if in use as indicated by the 'option overload' option) MUST begin with the first octet of the field, MUST be terminated by an 'end' option, and MUST be followed by 'pad' options to fill the remainder of the field.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The options in the 'options' field MUST be interpreted first, so that any 'option overload' options may be interpreted.",
        "req_type": "",
        "req_fields": [
            "options"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Any individual option in the 'options', 'sname' and 'file' fields MUST be entirely contained in that field.",
        "req_type": "",
        "req_fields": [
            "options",
            "sname",
            "file"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The 'file' field MUST be interpreted next (if the 'option overload' option indicates that the 'file' field contains DHCP options), followed by the 'sname' field.",
        "req_type": "",
        "req_fields": [
            "file",
            "sname",
            "option overload"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Options may appear only once, unless otherwise specified in the options document.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The IP destination address (in the IP header) is set to the DHCP 'yiaddr' address and the link-layer destination address is set to the DHCP 'chaddr' address.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "A client that cannot receive unicast IP datagrams until its protocol software has been configured with an IP address SHOULD set the BROADCAST bit in the 'flags' field to 1 in any DHCPDISCOVER or DHCPREQUEST messages that client sends.",
        "req_type": "DHCPDISCOVER, DHCPREQUEST",
        "req_fields": [
            "flags"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "A server or relay agent sending or relaying a DHCP message directly to a DHCP client (i.e., not to a relay agent specified in the 'giaddr' field) SHOULD examine the BROADCAST bit in the 'flags' field.",
        "req_type": "",
        "req_fields": [
            "flags",
            "giaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the BROADCAST bit is cleared to 0, the message SHOULD be sent as an IP unicast to the IP address specified in the 'yiaddr' field and the link-layer address specified in the 'chaddr' field.",
        "req_type": "",
        "req_fields": [
            "BROADCAST bit",
            "yiaddr",
            "chaddr"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The DHCPDISCOVER message MAY include options that suggest values for the network address and lease duration.",
        "req_type": "DHCPDISCOVER",
        "req_fields": [
            "options"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "Step 3: The client receives one or more DHCPOFFER messages from one or more servers.",
        "req_type": "",
        "req_fields": [],
        "res_type": "DHCPOFFER",
        "res_fields": []
    },
    {
        "rule": "Step 2: Each server may respond with a DHCPOFFER message that includes an available network address in the 'yiaddr' field (and other configuration parameters in DHCP options).",
        "req_type": "DHCPDISCOVER",
        "req_fields": [],
        "res_type": "DHCPOFFER",
        "res_fields": [
            "yiaddr"
        ]
    },
    {
        "rule": "The client broadcasts a DHCPREQUEST message that MUST include the 'server identifier' option to indicate which server the client has selected, and that MAY include other options specifying desired configuration values.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "server identifier"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The 'requested IP address' option MUST be set to the value of 'yiaddr' in the DHCPOFFER message from the server.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "requested IP address"
        ],
        "res_type": "DHCPOFFER",
        "res_fields": [
            "yiaddr"
        ]
    },
    {
        "rule": "To help ensure that any BOOTP relay agents forward the DHCPREQUEST message to the same set of DHCP servers that received the original DHCPDISCOVER message, the DHCPREQUEST message MUST use the same value in the DHCP message header's 'secs' field and be sent to the same IP broadcast address as the original DHCPDISCOVER message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [
            "secs"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The combination of 'client identifier' or 'chaddr' and assigned network address constitute a unique identifier for the client's lease and are used by both the client and server to identify a lease referred to in any DHCP messages.",
        "req_type": "",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The server selected in the DHCPREQUEST message commits the binding for the client to persistent storage and responds with a DHCPACK message containing the configuration parameters for the requesting client.",
        "req_type": "DHCPREQUEST",
        "req_fields": [],
        "res_type": "DHCPACK",
        "res_fields": [
            "configuration parameters"
        ]
    },
    {
        "rule": "Any configuration parameters in the DHCPACK message SHOULD NOT conflict with those in the earlier DHCPOFFER message to which the client is responding.",
        "req_type": "DHCPOFFER",
        "req_fields": [
            "configuration parameters"
        ],
        "res_type": "DHCPACK",
        "res_fields": [
            "configuration parameters"
        ]
    },
    {
        "rule": "The 'yiaddr' field in the DHCPACK messages is filled in with the selected network address.",
        "req_type": "",
        "req_fields": [],
        "res_type": "DHCPACK",
        "res_fields": [
            "yiaddr"
        ]
    },
    {
        "rule": "If the selected server is unable to satisfy the DHCPREQUEST message (for example, the requested network address has been allocated), the server SHOULD respond with a DHCPNAK message.",
        "req_type": "DHCPREQUEST",
        "req_fields": [],
        "res_type": "DHCPNAK",
        "res_fields": []
    },
    {
        "rule": "The server SHOULD mark an address offered to a client in a DHCPOFFER message as available if the server receives no DHCPREQUEST message from that client.",
        "req_type": "DHCPREQUEST",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the client detects that the network address is already in use (for example, through the use of ARP), the client MUST send a DHCPDECLINE message to the server and restarts the configuration process.",
        "req_type": "DHCPDECLINE",
        "req_fields": [],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "The client SHOULD perform a final check on the parameters (for example, ARP for allocated network address), and notes the duration of the lease specified in the DHCPACK message.",
        "req_type": "",
        "req_fields": [],
        "res_type": "DHCPACK",
        "res_fields": [
            "lease duration"
        ]
    },
    {
        "rule": "The client identifies the lease to be released with its 'client identifier', or 'chaddr' and network address in the DHCPRELEASE message.",
        "req_type": "DHCPRELEASE",
        "req_fields": [
            "client identifier",
            "chaddr",
            "network address"
        ],
        "res_type": "",
        "res_fields": []
    },
    {
        "rule": "If the client used a 'client identifier' when it obtained the lease, the client MUST use the same 'client identifier' in the DHCPRELEASE message.",
        "req_type": "DHCPRELEASE",
        "req_fields": [
            "client identifier"
        ],
        "res_type": "",
        "res_fields": []
    }
]