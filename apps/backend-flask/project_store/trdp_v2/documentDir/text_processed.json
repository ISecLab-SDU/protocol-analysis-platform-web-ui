{
  "Train Real-Time Data Protocol (TRDP) -> A.1 General": "3515 This annex defines the train real-time data protocol (TRDP) which shall be used for the 3516 All TRDP data on the wire is defined as big endian and byte alignment. Possible marshalling of 3521 NOTE 1 Also the optional safety layer uses the data in wire format (big endian and byte alignment). 3525 NOTE 2 TRDP transmits data 1-byte aligned. If the data contain VDPs as defined in Annex B, the VDPs itself are 3526 3528",
  "Train Real-Time Data Protocol (TRDP) -> A.1 General -> Figure A.1 â Overview of the protocol stack": "3529 _IEC_ Ethernet TCP/UDP TRDPother Application Ethernet TCP/UDP TRDP other Application END DEVICE END DEVICE TRDP protocol TRDP safe data TCN IEC CD 61375-2-3 © IEC 2024 - 131 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.2 Lower Layers": "3530",
  "Train Real-Time Data Protocol (TRDP) -> A.2 Lower Layers -> A.2.1 Data link layer": "3531 TRDP uses the ETB as defined in IEC 61375-2-5 for data communication within trains. 3532",
  "Train Real-Time Data Protocol (TRDP) -> A.2 Lower Layers -> A.2.2 Network Layer": "3533 TRDP is based on IP (RFC 791) for data exchange between functions located in different 3534 IP Addressing of functions and devices is defined in IEC 61375-2-5 and in this part of 3536 Data transfer between ETB and CN is provided by a gateway functionality of the ETBN as 3538 NOTE 1 The filtering of inconsistent data within the ETBN reduces the probability that inconsistent data are 3545 NOTE 2 A possible implementation will be to define corresponding firewall rules for the IP router within the ETBN 3548 NOTE 3 Depending on the safety and security concept ordinary process data and message data might use 3550 3552",
  "Train Real-Time Data Protocol (TRDP) -> A.2 Lower Layers -> A.2.3 Transport Layer": "3553 TRDP uses the services of the UDP (RFC 768) and TCP (RFC 793) transport layer protocols 3554 Any TRDP process data shall be sent with UDP. TRDP process data packet size shall be 3556 TRDP message data may be sent with UDP or with TCP. The choice shall be done by the user 3558 NOTE Message data packets exceeding the Ethernet MTU in size (about 1 500 bytes) can be transmitted by TCP 3560 For interoperable data communication, the destination port assignments (well-known ports) 3562",
  "Train Real-Time Data Protocol (TRDP) -> A.2 Lower Layers -> A.2.3 Transport Layer -> Table A.1 â UDP/TCP port assignments (well known ports)": "3564 **Protocol Destination Port** Process Data (UDP) 17224 Message Data (UDP/TCP) 17225 3565 For receiving UDP message data reply telegrams the port the related request was sent from 3568 IEC CD 61375-2-3 © IEC 2024 - 132 - 9/3102/CD For sending UDP message data reply telegrams any source port different from the one the 3573 TCP connections shall be established between a source port different from the well-known port 3575 Using different port numbers from those defined in Table A.1 may be allowed for project specific 3577 The used well-known port numbers should be given as a configuration parameter to the 3579 IEC CD 61375-2-3 © IEC 2024 - 133 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.3 TRDP FCS computation": "3581 For TRDP FCS CRC computation the CRC32 according to IEEE802.3 is used. The CRC 3582 Based on the table below the following algorithm in C programming language notation with start 3585 /******************************************************************************* 3587",
  "Train Real-Time Data Protocol (TRDP) -> A.3 TRDP FCS computation -> Figure A.2 â FCS Computation": "3611 3612 3613 IEC CD 61375-2-3 © IEC 2024 - 134 - 9/3102/CD **The FCS-32 generator polynomial:** 3614 *** x**0** +**x**1** +**x**2** +**x**4** +**x**5** +**x**7** +**x**8** +**x**10** +**x**11** +**** 3615 *** x**12** +**x**16** +**x**22** +**x**23** +**x**26** +**x**32**. 3616",
  "Train Real-Time Data Protocol (TRDP) -> A.3 TRDP FCS computation -> Figure A.3 â FCS Table": "3685 IEC CD 61375-2-3 © IEC 2024 - 135 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.4 Interaction between TRDP user and TRDP Layer": "3686 The TRDP layer shall provide services for process data and message data communication to 3687 3691",
  "Train Real-Time Data Protocol (TRDP) -> A.4 Interaction between TRDP user and TRDP Layer -> Figure A.4 â TRDP service model": "3692",
  "Train Real-Time Data Protocol (TRDP) -> A.5 Communication Identifier (ComId)": "3693 All TRDP communication is using a so called ComId transmitted in the header of each PDU. 3694 The ComId forms, together with source IP address and destination IP address, a unique 3696 The ComId is application dependent but should be standardized in the application profiles. It 3698 â¢ structure (data set) (one-to-one relation) 3700 The ComId shall be set to zero (ComId = 0) in the following cases: 3709 â¢ for PDUs with unspecified user dataset. 3710 The ComIds 1..999 shall not be used by the application since they are reserved for specific 3713 _IEC_ TRDP User (Application) TRDP Layer TRDP service TCP/UDP service user service provider IEC CD 61375-2-3 © IEC 2024 - 136 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.5 Communication Identifier (ComId) -> Table A.2 â Reserved ComIds": "3715 **comId Description** 0 unspecified PDU service service service 3716 IEC CD 61375-2-3 © IEC 2024 - 137 - 9/3102/CD **comId Description** 104 TTDB â consist information request service service 3717 IEC CD 61375-2-3 © IEC 2024 - 138 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data": "3718",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.1 Communication model": "3719 The TRDP process data protocol defines the exchange of PD-PDUs for the transfer of any 3720 PD-PDUs shall be cyclically transmitted or on request between a publisher and one or many 3722",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.2 Roles": "3725 The communication partners in a process data transfer can have different roles: 3726 publisher: the source of process data subscriber: the sink of process data requester: requesting the publisher(s) to publish its process data Publisher and requester coincide in push communication pattern. 3727 A subscriber may also be a requester in pull communication patterns. 3728",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.3 Communication pattern": "3729",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.3 Communication pattern -> A.6.3.1 Push communication pattern": "3730 Process data exchange shall support the following push communication pattern as defined in 3731 a) point to point, cyclic without acknowledge, source knows the sink (Figure A.5); 3733 groups (Figure A.6); 3735 (Figure A.6). 3737 NOTE 1 From communication point of view there will be no difference in a point to multipoint communication 3738 NOTE 2 Cyclic transmission can be triggered by TRDP layer or by application. 3740 IEC CD 61375-2-3 © IEC 2024 - 139 - 9/3102/CD 3741",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.3 Communication pattern -> Figure A.5 â PD push pattern (point to point)": "3742 3743",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.3 Communication pattern -> Figure A.6 â PD push pattern (point to multipoint)": "3744",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.3 Communication pattern -> A.6.3.2 Pull communication pattern": "3745 Process data exchange shall support the following pull communication pattern as defined in 3746 â¢ Point to point, without acknowledge, sink knows the source (Figure A.7). 3748 dedicated subscriber is requesting the known publisher to send its PD-PDU. 3751 (Figure A.10). Here, one dedicated subscriber is requesting one or multiple unknown 3753 _IEC_ publisher subscriber PD-PDU (data) PD publish PD-PDU (data) PD-PDU (data) PD publish PD publish PD consumption _IEC_ subscribersubscriberpublisher subscriber PD-PDU (data) PD consumption PD publish PD-PDU (data) PD-PDU (data) PD publish PD publish PD consumption IEC CD 61375-2-3 © IEC 2024 - 140 - 9/3102/CD 3755",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.3 Communication pattern -> Figure A.7 â PD pull pattern (point to point, sink knows source)": "3756 _IEC_ publisher requester / PD-PDU(reply) PD-PDU(request) PD-PDU(reply) PD-PDU(request) PD-PDU(reply) PD-PDU(request) IEC CD 61375-2-3 © IEC 2024 - 141 - 9/3102/CD 3757",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.3 Communication pattern -> Figure A.8 â PD pull pattern (multipoint to point, sink does not know source)": "3758 _IEC_ publisher requester / PD-PDU(reply) PD-PDU(request) publisher PD-PDU(reply)PD-PDU(reply) PD-PDU(reply) PD-PDU(request) PD-PDU(reply)PD-PDU(reply) PD-PDU(reply) PD-PDU(request) PD-PDU(reply)PD-PDU(reply) IEC CD 61375-2-3 © IEC 2024 - 142 - 9/3102/CD 3759",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.3 Communication pattern -> Figure A.9 â PD pull pattern (point to multipoint, sink knows source)": "3760 _IEC_ subscriber publisher requester / PD-PDU(reply) PD-PDU(request) PD-PDU(reply) PD-PDU(request) PD-PDU(reply) PD-PDU(request) IEC CD 61375-2-3 © IEC 2024 - 143 - 9/3102/CD 3761",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.3 Communication pattern -> Figure A.10 â PD pull pattern (multipoint to multipoint, sink does not know source)": "3762",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.4 Addressing": "3763 A publisher/subscriber shall use an IP unicast address for addressing a known 3764 A publisher/subscriber shall use an IP multicast address for addressing groups of known 3766 A publisher/subscriber shall use an IP multicast address for addressing unknown 3768 Address ranges which can be used for process data communication are defined in IEC 61375-3770",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.5 PD-PDU": "3772 The structure of a PD-PDU is defined in Figure A.11 and in ASN.1 notation, with additional 3773 _IEC_ subscribersubscriberpublisher requester / PD-PDU(reply) PD-PDU(request) publisher PD-PDU(reply)PD-PDU(reply) PD-PDU(reply) PD-PDU(request) PD-PDU(reply)PD-PDU(reply) PD-PDU(reply) PD-PDU(request) PD-PDU(reply)PD-PDU(reply) IEC CD 61375-2-3 © IEC 2024 - 144 - 9/3102/CD 3775",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.5 PD-PDU -> Figure A.11 â PD-PDU": "3776 PD_PDU::= RECORD 3777 _IEC_ **dataset** 0 15 16 317 8 23 24**sequenceCounter** **protocolVersion** **etbTopoCnt** **datasetLength** **replyComId** **msgType** 40 octets **reserved** **replyIpAddress** 24 octets **headerFCS** **opTrnTopoCnt** IEC CD 61375-2-3 © IEC 2024 - 145 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.5 PD-PDU -> Table A.3 â PD-PDU parameters": "3797 **Parameter Description Value** sequenceCounter The sequence counter: â¢ Shall be managed for sending process telegrams per â¢ Shall be managed (stored) for received process â¢ Shall be incremented with each sending of the process â¢ Can be used for communication layer surveillance (PD A surveillance that the application is still updating its process Computed, protocolVersion The protocol version shall consist of: incompatible changes compatible changes Fixed msgType Type of the telegram. â5072âH (âPrâ) comId Identifier of the user dataset. See also A.5. set by user â¢ shall be used (train addressing) as defined in IEC 61375- â¢ shall be set by the user not used. 0..232-1 set by user opTrnTopoCnt The operational train topography counter: use information from the operational train directory (e.g. â¢ shall be set when the source device used the operational â¢ optional in all other cases. Shall be set to 0 (= invalid) if datasetLength The dataset length: octets without padding octets. 0..1432 IEC CD 61375-2-3 © IEC 2024 - 146 - 9/3102/CD **Parameter Description Value** â¢ shall be the primary information about the user data NOTE In case of fixed size data sets this is redundant reserved â¢ Reserved for future use. set to 0 â¢ shall be used only in a PD request the reply 0, the reply shall be sent as an unspecified PDU. Set by user in replyIpAddress The reply IP address for PD: be used for the reply. set by user for headerFCS The header frame check sequence: Computed dataset The user data 3798",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.6 Interaction between application and TRDP protocol layer": "3799",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.6 Interaction between application and TRDP protocol layer -> A.6.6.1 Service primitives": "3800 The TRDP layer shall provide a service for process data communication to the TRDP user at 3801 NOTE The service primitives are defined in an abstract way in order not to restrict implementations. The 3803",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.6 Interaction between application and TRDP protocol layer -> Table A.4 â TRDP service primitives": "3805 **Role Service primitive Parameter Description** Publisher PD.publish TRDP user â' TRDP layer handle Handle for this publishing, returned userRef Optional user reference for call callBackFunction Optional call back function. Set to 0 reserved as defined in Table A.3 IEC CD 61375-2-3 © IEC 2024 - 147 - 9/3102/CD **Role Service primitive Parameter Description** sourceIpAddress Source IP Address of the PD. PD to. Set to 0 for application triggered PD datasetLength Actual user data length to be sent dataset Buffer with user data to be sent as redId Redundancy group ID. Set to 0 if PD.rePublish TRDP user â' TRDP layer handle Handle which has been given by the etbTopoCnt as defined in Table A.3 opTrnTopoCnt as defined in Table A.3 sourceIpAddress Source IP Address of the PD. destinationIpAddress Destination IP address to send the PD.unPublish TRDP user â' TRDP layer handle Handle which has been given by the PD.putData TRDP user â' TRDP layer handle Handle which has been given by the datasetLength Actual user data length to be sent dataset Buffer with user data to be sent as PD.setRed TRDP user â' TRDP layer IEC CD 61375-2-3 © IEC 2024 - 148 - 9/3102/CD **Role Service primitive Parameter Description** redId Selects the redundancy group to be leader If TRUE, the service activates PD.getRed TRDP user â' TRDP layer redId Selects the redundancy group to be leader If TRUE, publishing is activated for PD.putDataImmediate TRDP user â' TRDP layer handle Handle which has been given by the txTime Absolute time to transmit or 0 for datasetLength Actual user data length to be sent dataset Buffer with user data to be sent as Requester PD.request TRDP user â' TRDP layer handle handle for this subscription of the reserved as defined in Table A.3 comId ComId to be sent, as defined in etbTopoCnt as defined in Table A.3 sourceIpAddress Source IP address destinationIpAddress Destination IP address to send the redId Redundancy ID. Set to 0 if dataSet User data set to be sent, as defined datasetLength data set length to be sent, as IEC CD 61375-2-3 © IEC 2024 - 149 - 9/3102/CD **Role Service primitive Parameter Description** replyComId as defined in Table A.3 Subscriber PD.subscribe TRDP user â' TRDP layer handle handle for this subscription; userRef Optional user reference for call callBackFunction Optional call back function. Set to 0 reserved as defined in Table A.3 comId as defined in Table A.3 etbTopoCnt as defined in Table A.3 opTrnTopoCnt as defined in Table A.3 respective URIâs using DNS. sourceIpAddress2 Defines the upper IP address in destinationIpAddress IP destination address, generated timeout Timeout (rxTime) for PD to be timeoutBehaviour Optional behaviour in case of a PD_resubscribe TRDP user â' TRDP layer handle handle for this subscription; etbTopoCnt as defined in Table A.3 opTrnTopoCnt as defined in Table A.3 sourceIpAddress1 IP source address, generated out of IEC CD 61375-2-3 © IEC 2024 - 150 - 9/3102/CD **Role Service primitive Parameter Description** Defines the lower IP address in sourceIpAddress2 Defines the upper IP address in destinationIpAddress IP destination address, generated PD.unsubscribe TRDP user â' TRDP layer handle handle returned by the TRDP layer PD.indicate TRDP layer â' TRDP user handle handle returned by the TRDP layer sourceIpAddress Received source IP address destinationIpAddress Received destination IP address, as sequenceCounter Received sequence counter, as protocolVersion Received protocol version, as imsgType â¢ process data (âPdâ) comId Received ComId, as defined in etbTopoCnt Received topo count, as defined in opTrnTopoCnt Received topo count, as defined in replyIComId Received reply ComId, as defined in replyIpAddress Received reply IP address userRef User reference given in status 0 OK, != 0 NOK â¢ 1 â timeout IEC CD 61375-2-3 © IEC 2024 - 151 - 9/3102/CD **Role Service primitive Parameter Description** â¢ 6 â no subscription timeoutBehaviour Optional behaviour in case of a reserved as defined in Table A.3 dataset Received user data, as defined in datasetLength Received user data size, as defined PD.get TRDP user â' TRDP layer handle handle returned by the TRDP layer sourceIpAddress Received source IP address destinationIpAddress Received destination IP sequenceCounter Received sequence counter, as protocolVersion Received protocol version, as msgType â¢ process data (âPdâ) comId Received ComId, as defined in etbTopoCnt Received topo count, as defined in opTrnTopoCnt Received topo count, as defined in replyIComId Received reply ComId, as defined in replyIpAddress Received reply IP address userRef User reference given in status 0 OK, != 0 NOK â¢ 1 â timeout timeoutBehaviour Optional behaviour in case of a reserved as defined in Table A.3 IEC CD 61375-2-3 © IEC 2024 - 152 - 9/3102/CD **Role Service primitive Parameter Description** dataset Received user data, as defined in datasetLength Received user data size, as defined 3806",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.6 Interaction between application and TRDP protocol layer -> A.6.6.2 PD User access": "3807 The TRDP user shall have two possibilities to retrieve PD: either via a poll mechanism, typically 3808",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.6 Interaction between application and TRDP protocol layer -> A.6.6.3 Interaction sequence â PD Pull Pattern": "3811 The sequence chart in Figure A.12 defines the allowed sequence of the service primitives for 3812 NOTE 1 Dotted lines in the sequence charts are used to indicate options. 3815 Process data are prepared cyclically by the publisher and shall be given to the TRDP layer 3816 To receive a request, the publisher shall subscribe for it. 3818 Until receiving the first request telegram matching to the filter criteria of the subscription, related 3819 Also a request for already cyclically published PDU shall be possible. 3821 Topography counters of an incoming request telegram shall be checked in accordance to A.6.7. 3822 Each incoming request telegram shall be responded by the TRDP layer using the available 3823 If the reply IP address of the request telegram is 0, the source IP address of the request 3825 To receive the related reply for a request, the requester needs to subscribe for it. Destination 3827 Until receiving the first reply telegram matching to the filter criteria of the subscription, related 3829 NOTE 2 This is to prevent that the user fetches outdated reply data after it has requested new reply data. 3833 Timeout supervision at subscriber TRDP layer shall be restarted after sending the request 3834 The request can contain user data. 3836 Before sending out a request, the TRDP layer shall check the topology counters submitted with 3837 3840 IEC CD 61375-2-3 © IEC 2024 - 153 - 9/3102/CD 3841",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.6 Interaction between application and TRDP protocol layer -> Figure A.12 â Interaction sequence chart for PD pull pattern": "3842",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.6 Interaction between application and TRDP protocol layer -> A.6.6.4 Interaction sequence â PD Push Pattern": "3843 The PD push pattern can be used for any PD. 3844 The sequence charts in Figure A.13 and Figure A.14 define the allowed sequence of the service 3845 1\\. In Figure A.13 process data are prepared cyclically by the publisher and shall be given to 3848 2\\. In Figure A.14 process data are prepared cyclically by the by the publisher and shall be 3851 The publisher TRDP layer shall send out the data only after checking the locally stored 3854 Any subscriber can subscribe for the process telegram using ComID, destination IP address 3857 Timeout supervision at subscriber TRDP layer shall be started after subscription. 3859 Timeout supervision at subscriber TRDP layer shall be restarted after receiving the related PD 3860 The subscriber TRDP layer shall check the topography counters of the received telegram 3862 Until receiving the first valid telegram matching to the filter criteria the data shall be marked as 3866 _IEC_ TRDP TRDP **publisher/subscriber** TRDP TRDP **requester/subscriber** request telegram process data telegram PD.putData PD.indicate(data) PD.request PD.subscribe PD.putData PD.subscribe PD.poll PD.indicate(timeout) PD.publish IEC CD 61375-2-3 © IEC 2024 - 154 - 9/3102/CD 3868",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.6 Interaction between application and TRDP protocol layer -> Figure A.13 â Interaction sequence chart for PD push pattern used for TRDP layer": "3869 **triggered PD cycle** 3870 3871",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.6 Interaction between application and TRDP protocol layer -> Figure A.14 â Interaction sequence chart for PD push pattern, used for application": "3872 **triggered PD cycle** 3873 3874",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.6 Interaction between application and TRDP protocol layer -> A.6.6.5 PD Redundancy Handling": "3875 The sequence chart in Figure A.15 shows the sequence of the service primitives for redundancy 3876 The service primitives for redundancy handling shall be used in the same way by the publisher 3878 If a redundant function enters the redundancy leader state it shall call PD.setRed(LEADER) for 3880 If a redundant function enters the redundancy follower state it shall call PD.setRed(!LEADER) 3883 Starting TRDP, publishers of redundant process data (identified by a ComId marked as 3886 _IEC_ TRDP TRDP **publisher** TRDP TRDP **subscriber** process data telegram PD.indicate(data) PD.publish PD.indicate(timeout) PD.subscribe PD.putData PD.poll PD.putData _IEC_ TRDP TRDP **publisher** TRDP TRDP **subscriber** IEC CD 61375-2-3 © IEC 2024 - 155 - 9/3102/CD 3889",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.6 Interaction between application and TRDP protocol layer -> Figure A.15 â Interaction sequence chart for redundant PD handling": "3890",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.7 Topography counter check": "3891 Before sending a telegram, the topography counters of the telegram shall be checked against 3892 After reception of a telegram, the topography counter values shall be checked in two steps to 3895 The topography counter check is passed if at least one of the cases listed in Table A.5 came 3900",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.7 Topography counter check -> Table A.5 â Topography counter check": "3902 **Publisher Actual topography counter values Locally stored topography counter values** **Subscriber Actual topography counter values Topography counter values of the received** **Topography counter values of the** **Locally stored topography counter values** **Case** etbTopoCnt opTrnTopoCnt etbTopoCnt opTrnTopoCnt 3 equal any equal 0 5 (3) 0 0 any any (3) Only relevant for the comparison of the topography counter values of the received telegram with the locally (4) Case applies only for subscriber comparing topography counter values of the received telegram with the locally Key: 0 = topography counter value set to 0 (donât care ) _IEC_ TRDP TRDP **publisher** TRDP TRDP **subscriber** IEC CD 61375-2-3 © IEC 2024 - 156 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine": "3903",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> A.6.8.1 Publishing PD-PDU(data)": "3904 A publisher shall publish PD-PDU(data) when: 3905 â¢ the defined time cycle terminates (push pattern, TRDP triggered cycle) 3906 â¢ it receives an application request to send the data immediately (push pattern, application 3907 â¢ it receives a request from a dedicated subscriber or an independent communication 3909 To not overload subscribers, the publisher of TRDP triggered pushed PD-PDU shall apply a 3911 The publishing of PD-PDU(data) is defined with the state diagram depicted in Figure A.16. 3913 NOTE 1 Sending application triggered cyclic PD-PDUs shall be restricted since there is no possibility to include 3914 NOTE 2 If there is a pull request for a PD-PDU that is already published using the push pattern, the related reply is 3916 3918",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Figure A.16 â PD State diagram publisher": "3919 Guards, triggers, actions and states are described in Table A.6 to Table A.9. 3920",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Table A.6 â PD publisher state diagram â guards": "3921 **Guards Description** pattern configured communication pattern for the PD-PDU exchange Values: PUSH checkTopoCounts Check the locally stored topology counters submitted with the publish against 3922 _IEC_ [pattern == PUSH] PD.publish timeout CyclicOperation PolledOperation [pattern == PULL] PD.putData / restartTimer(txTime) PD.putData PD.unpublish requestReceived [OK] [ELSE] / stopPublishing [appTriggeredCycle == FALSE][appTriggeredCycle == TRUE] ApplicationTriggeredOperation / preparePd PD.putDataImmediate / preparePd IEC CD 61375-2-3 © IEC 2024 - 157 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Table A.7 â PD publisher state diagram â triggers": "3923 **Triggers Description** PD.publish User called PD.publish service primitive continue publishing train-wide PD. topo count change (service primitive PD.putData) immediately (service primitive PD.putDataImmediate) 3924",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Table A.8 â PD publisher state diagram â actions": "3925 **Actions Description** updatePdTelegram Take process data packet from application and generate process data telegram for publishing â¢ HeaderFCS sendNonTsnPdTelegram publish (send) the process data telegram txTime = cycle time for sending PD as defined in PD.publish service stopPublishing Stop publishing on request, stop the timer 3926",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Table A.9 â PD publisher state diagram â states": "3927 **States Description** CyclicOperation The publisher sends PD-PDUs cyclically triggered by a timer 3928",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> A.6.8.2 Request publishing of PD-PDU (PD request)": "3929 One dedicated subscriber or an independent communication device may request one or many 3930 IEC CD 61375-2-3 © IEC 2024 - 158 - 9/3102/CD 3933",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Figure A.17 â PD State diagram requester": "3934 Triggers, actions and states are described in Table A.10 to Table A.13. 3935",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Table A.10 â PD publisher state diagram â guards": "3936 **Guards Description** checkTopoCounts Check the topography counters submitted with the request against the actual topography counters. At least one of the cases listed in Table A.5 3937",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Table A.11 â PD requester state diagram â triggers": "3938 **Triggers Description** PD.request PD.request service primitive called by application 3939",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Table A.12 â PD requester state diagram â actions": "3940 **Actions Description** prepareRequestTelegram prepare a request telegram to one or many publishers time = rxTime (timeout value given in PD.subscribe service primitive) 3941",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Table A.13 â PD requester state diagram â states": "3942 **States Description** Request The requester sends request telegram. Sending of the request telegram is triggered by the application using PD.request. 3943 _IEC_ PD.request Request Start IEC CD 61375-2-3 © IEC 2024 - 159 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> A.6.8.3 Receiving PD-PDU (PD reply/data)": "3944 For an eventually related PD request see Figure A.17. 3945 3946",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Figure A.18 â PD State diagram subscriber": "3947 Triggers, actions and states are described in Table A.14 to Table A.17. 3948",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Table A.14 â PD subscriber state diagram â triggers": "3949 **Triggers Description** PD.subscribe PD.subscribe service primitive called by application continue receiving train-wide published PD. PD after topo count change. 3950",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Table A.15 â PD subscriber state diagram â guards": "3951 **Guards Description** pattern configured communication pattern for the PD-PDU exchange checkTopoCounts Check the topography counters of the received telegram against the 3952 _IEC_ PD.subscribe WaitForPD PD.unsubscribe pdReceived [OK] [else] [pattern == PUSH] [pattern == PULL] [pattern == PUSH] [pattern == PULL] IEC CD 61375-2-3 © IEC 2024 - 160 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Table A.16 â PD subscriber state diagram â actions": "3953 **Actions Description** indicate(data) Notify application about a new received process or request telegram (service primitive PD.indicate) Check filter criteria setDataInvalid Sets the PD to initialized/invalid time = rxTime (timeout value given in PD.subscribe service primitive) Discard Discard the telegram",
  "Train Real-Time Data Protocol (TRDP) -> A.6 Process Data -> A.6.8 State Machine -> Table A.17 â PD subscriber state diagram â states": "3955 **States Description** WaitForPD Wait until a new process telegram is received 3956 IEC CD 61375-2-3 © IEC 2024 - 161 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data": "3957",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.1 Communication model": "3958 The TRDP message data protocol defines the message data exchange between a caller and 3959 NOTE This gives a âguaranteedâ transfer of data as the caller/replier is notified about the correct reception and 3965 A caller shall be able to define by the request type whether a reply is expected or not. 3967 A replier shall be able to define by the reply type whether a confirmation of its reply is expected 3968 As a consequence, three message data transfer options shall be provided by TRDP 3970 a) request without reply (ânotificationâ); 3972 TRDP shall provide two mechanisms to transfer message data (via UDP and via TCP); the 3975 3977",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.1 Communication model -> Figure A.19 â Message data transfer options": "3978",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.2 Roles": "3979 The communication partners in a message data transfer can have different roles: 3980 caller: the source of message data in push communication pattern the sink of message data in pull communication pattern replier: the source of message data in pull communication pattern the sink of message data in push communication pattern _IEC_ caller replier request request caller replier request reply processing the caller replier request reply confirm processing the processing the a) b) c) IEC CD 61375-2-3 © IEC 2024 - 162 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.3 Communication pattern": "3981",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.3 Communication pattern -> A.7.3.1 Push communication pattern": "3982 Message data exchange shall support the following push communication pattern as defined in 3983 a) point to point , sporadic with acknowledge, source knows the sink; 3985 NOTE e) is not required in IEC 61375-1. 3991",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.3 Communication pattern -> A.7.3.2 Pull communication pattern": "3992 Message data exchange shall support the following pull communication pattern as defined in 3993 a) point to point , sporadic with acknowledge, sink knows the source; 3995 NOTE e) is not required in IEC 61375-1. 4001",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.4 Addressing": "4002 A caller shall use an IP unicast address or an IP multicast address for addressing known 4003 A caller shall use an IP multicast address for addressing unknown repliers. 4005 A caller may use an IP multicast address for addressing a known replier redundancy group. 4006 A replier shall respond to the callerâs unicast address. 4007 Address ranges which can be used for message data communication are defined in IEC 61375-4008",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.5 MD-PDU": "4010 The structure of a MD-PDU is defined in Figure A.20 and subsequently in ASN.1 notation, with 4011 IEC CD 61375-2-3 © IEC 2024 - 163 - 9/3102/CD 4013",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.5 MD-PDU -> Figure A.20 â MD-PDU": "4014 **MD_PDU::= RECORD** 4015 request 4027",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.5 MD-PDU -> Table A.18 â MD-PDU parameters": "4034 **Parameter Description Value** sequenceCounter The sequence counter â¢ shall be incremented with each repetition of the Computed _IEC_ 0 15 16 317 8 23 24**sequenceCounter** **protocolVersion** **etbTopoCnt** **datasetLength** **msgType** **sessionId** **sourceUri** **destinationUri** **replyTimeout** **dataset** 0..65388 octets **headerFcs** **opTrnTopoCnt** IEC CD 61375-2-3 © IEC 2024 - 164 - 9/3102/CD **Parameter Description Value** â¢ shall be returned with the reply message protocolVersion The protocol version shall consist of: for incompatible changes, compatible changes Fixed msgType Type of the telegram. â4D6EâH (âMnâ) comId Identifier of the user dataset. See also A.5. set by user etbTopoCnt The topography counter: standard part IEC 61375-2-5 (parameter â¢ shall be set by the user if not used. 0..232-1 opTrnTopoCnt The topography counter: which use information from the operational train â¢ shall be set when the source device used the â¢ optional in all other cases. Shall be set to 0 (= invalid) datasetLength Length of the user data set in number of octets without 0 ..65388 Computed replyStatus The status value shall be set by the replier to report the â¢ â1 â reserved < 0: NOK IEC CD 61375-2-3 © IEC 2024 - 165 - 9/3102/CD **Parameter Description Value** â¢ â6 â no reply sessionId The session identification: confirmâ session which is composed of a caller â¢ shall identify a ârequest-errorâ session when the â¢ shall be computed at caller side and reused at replier â¢ shall be used at caller side to relate a reply or error â¢ shall be used at replier side to identify a â¢ shall be a UUID according to RFC 4122, time-based Computed replyTimeout The reply timeout value shall be set to define the expected 1 .. (232-1) sourceUri The source URI: and â@â destinationUri The destination URI: and â@â headerFcs The header frame check sequence: Computed according dataset The user data.",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.6 Interaction between application and TRDP layer": "4035",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.6 Interaction between application and TRDP layer -> A.7.6.1 Service primitives": "4036 The TRDP layer shall provide services for message data communication to the TRDP user. The 4037 IEC CD 61375-2-3 © IEC 2024 - 166 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.6 Interaction between application and TRDP layer -> Table A.19 â TRDP service primitives â Caller": "4041 **Service primitive Parameters Direction/Description** MD.request msgType â¢ send notification message (âMnâ) userReference Reference returned with the MD.indication. Used by user to callbackFunction Callback function for the incoming reply. sessionId session identifier used and returned by the TRDP layer. comId as defined in Table A.18 etbTopoCnt as defined in Table A.18 opTrnTopoCnt as defined in Table A.18 sourceIpAddr IP source address. destinationIpAddr IP destination address, generated out of respective URIâs using transProtocol UDP or TCP transport layer protocol number of repliers if the request message is sent to known replyTimeOut as defined in Table A.18 range 0..2. MD.indicate TRDP layer â' TRDP user userReference Reference which was submitted with MD.request â¢ reception of a query message (âMqâ) comId as defined in Table A.18 Set to 0 if unknown (error return) Set to 0 if unknown (error return) IEC CD 61375-2-3 © IEC 2024 - 167 - 9/3102/CD **Service primitive Parameters Direction/Description** userStatus User status or error code. MD.confirm TRDP user â' TRDP layer sessionId session identifier as returned by MD.indication. Used by the TRDP replyStatus as defined in Table A.18 TRDP user asks to abort an open session e.g because of a TCN sessionId session identifier used by the TRDP layer. 4042",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.6 Interaction between application and TRDP layer -> Table A.20 â TRDP service primitives â Replier": "4043 **Service primitive Parameters Direction/Description** MD.addListener Handle Handle for this listener, returned by the TRDP layer associate the listener with the MD.indication DNS. sourceIpAddress2 Defines the upper IP address in case of an IP address range destinationIpAddress IP destination address, generated out of respective URIâs IEC CD 61375-2-3 © IEC 2024 - 168 - 9/3102/CD **Service primitive Parameters Direction/Description** sourceURI[] as defined in Table A.18, only notification/request from that destinationURI as defined in Table A.18, only notification/request with that MD.readdListener TRDP user â' TRDP layer Handle Handle for this listener etbTopoCnt actual etbTopoCnt value opTrnTopoCnt actual opTrnTopoCnt value sourceIpAddress IP source address, generated out of respective URIâs using sourceIpAddress2 Defines the upper IP address in case of an IP address range destinationIpAddress IP destination address, generated out of respective URIâs MD.delListener TRDP user â' TRDP layer Handle Handle returned by the TRDP layer in MD.addListener TRDP layer informs about an event userReference Reference which was submitted with MD.addListener â¢ reception of a request message (âMrâ) comId as defined in Table A.18 Set to 0 if unknown (error return) Set to 0 if unknown (error return) IEC CD 61375-2-3 © IEC 2024 - 169 - 9/3102/CD **Service primitive Parameters Direction/Description** sourceUri as defined in Table A.18 MD.reply TRDP user â' TRDP layer msgType â¢ send reply message (âMpâ) sessionId Session identifier as indicated with MD.indication. Used by comId as defined in Table A.18 MD.release TRDP layer â' TRDP user userReference Reference which was submitted with MD.addListener â¢ TRDP layer error (âMeâ) Set to 0 if unknown (error return) Set to 0 if unknown (error return) 4044",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.6 Interaction between application and TRDP layer -> A.7.6.2 Interaction sequence": "4045 The sequence chart in Figure A.21 defines the sequence of the service primitives. 4046 IEC CD 61375-2-3 © IEC 2024 - 170 - 9/3102/CD 4047",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.6 Interaction between application and TRDP layer -> Figure A.21 â Interaction sequence chart": "4048",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.6 Interaction between application and TRDP layer -> A.7.6.3 Filtering rules": "4049 The service primitive MD.addListener allows to optionally define sourceUri and destinationURI 4050 a) An empty destinationUri in a MD telegrams shall be received by a listener regardless of 4052 b) An empty sourceUri in a MD telegrams has no special meaning. 4054 listener shall receive MD telegrams regardless of any defined destinationUri in the MD 4056 d) An empty sourceUri filter entry in MD.addListener service primitive means that the 4058 e) Any two listeners shall have a disjunctive set of filter parameters comId, sourceUri, 4061 f) MD telegrams with empty destinationUri may be received by several listeners with 4064 NOTE A MD telegram sent to a unicast IP destination address with empty destinationUri is a potential multicast â 4067",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.7 Topography counter check": "4069 Before sending a telegram, the topography counters of the telegram shall be checked against 4070 After reception of a telegram, the topography counter values shall be checked to ensure that 4073 _IEC_ TRDP TRDP **caller** TRDP TRDP **replier (listener)** MD.request MD.addListener request message MD.reply reply message MD.indicate MD.confirm confirm message MD.release IEC CD 61375-2-3 © IEC 2024 - 171 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.7 Topography counter check -> Table A.21 â Topography counter check": "4078 **Caller Actual topography counter values Topography counter values of the telegram to** **Replier Actual topography counter values Topography counter values of the received** **Topography counter values of the** **Locally stored topography counter values** **Case** etbTopoCnt opTrnTopoCnt etbTopoCnt opTrnTopoCnt 5(3) 0 0 any any (2) Only relevant for the comparison of the topography counter values of the received telegram with the locally (3) Case applies only for replier comparing topography counter values of the received telegram with the locally Key: 0 = topography counter value set to 0 (donât care) 4079",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine": "4080",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> A.7.8.1 TRDP Layer â Caller": "4081 If a TRDP user (caller) requests sending a message, its topography counters shall be checked 4082 If a TRDP user (caller) requests sending a notification, a notification message (MsgType âMnâ) 4085 If a TRDP user (caller) requests sending a request message, a caller session shall be opened 4087 To ensure that the session identifier is unique, each request-reply/request-reply-confirm 4089 A timeout value for the reply message(s) shall be defined by the TRDP user (caller). 4093 NOTE If retries are selected, the timeout at application layer can be up to (maxNumRetries + 1) Ã replyTimeout. 4094 During the caller session, the TRDP layer shall wait for incoming reply messages (MsgType 4095 If the number of expected incoming replies is reached and there are no more outstanding 4098 IEC CD 61375-2-3 © IEC 2024 - 172 - 9/3102/CD The confirmation shall use as destination URI the source URI received in the reply message. 4103 After getting the confirmation from TRDP user (caller), the TRDP layer shall send a confirmation 4104 A confirmation message shall not contain user data and shall be sent only as unicast. 4106 The TRDP user (caller) shall take care to provide the confirmation in time as indicated by the 4107 If the number of incoming replies is reached and the confirm timeout timer expires while waiting 4109 If the reply timeout timer of the caller session expires because of a missing reply and the number 4112 If the reply timeout timer expires and the number of expected repliers is greater than 1 and less 4116 If the number of repliers is not known (parameter NoOfRepliers = 0 and the reply timeout timer 4120 There shall be no retransmission of request messages if TCP is used. If for TCP retransmission 4123 If the TRDP layer receives a reply message (MsgType âMpâ, âMqâ or âMeâ) without having opened 4127 The topography counter values obtained during caller session opening shall be used throughout 4129 If a TRDP user receives a reply message with topography counter values different to the 4131 If a TRDP user aborts an (open) session (e.g. after a train topology change), running timers 4133 The behavior of the callerâs TRDP layer is depicted in Figure A.22 with explanations given in 4135 IEC CD 61375-2-3 © IEC 2024 - 173 - 9/3102/CD 4137",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Figure A.22 â TRDP layer MD caller state chart": "4138",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Table A.22 â MD caller state diagram â triggers": "4139 **Triggers Description** MD.request User called MD.request service primitive change of topography counters). 4140",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Table A.23 â MD caller state diagram â guards": "4141 **Guards Description** sendType Type of the MD request telegram as requested by the user in the MD.request service primitive (parameter âNoOfRepliersâ) length and topography counter (at least one of the cases listed in Table A.21 _IEC_ CompositeStateCaller MD.request / mdCallSession [sendType == âMrâ] StateWaitForReply [sendType == âMnâ] [missingReplies == 0 AND missingConfirms == 0] / leave Start Start (caller) MD.confirm mpReceived Start (mdHandleCallerTimeout) [(maxTimeoutCnt != 0) AND [else] meReceived / closeCallSession IEC CD 61375-2-3 © IEC 2024 - 174 - 9/3102/CD **Guards Description** checkTopoCounts Check the topology counters of the received message against the actual 4142",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Table A.24 â MD caller state diagram â actions": "4143 **Actions Description** mdCallSession Handles the states of a caller session. If sending the request message is repeated after timeout telegram sendConfirmMessage Sends the confirm message MD.indicate service primitive service primitive) 4144",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Table A.25 â MD caller state diagram â states": "4145 **States Description** CompositeStateCaller Composite state of the caller the reply/replies and optional requested confirmations from the application",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> A.7.8.2 TRDP Layer â Replier (Listener)": "4146 Each TRDP user (replier) that wants to receive MD shall register as listener for MD sent to a 4147 All incoming messages shall be checked against the actual topography counters. Messages not 4149 All incoming messages shall be checked against registered listeners. Any message to a not 4151 In case of a unicast request message to a not registered listener or to a listener expecting 4154 If a notification message (MsgType âMnâ) is received, the message shall be passed to the related 4157 If a request message (MsgType âMrâ) is received, a reply session shall be opened using the 4159 IEC CD 61375-2-3 © IEC 2024 - 175 - 9/3102/CD If a request message (MsgType âMrâ) is received for an open reply session with the received 4166 After receiving the MD.reply from the TRDP user (listener), the TRDP layer shall send, 4168 A reply message shall be sent only as unicast using source IP address and source URI of the 4171 The MD.reply of a listener shall use as source IP address the IP address of the listener and as 4175 If a reply message without confirmation (MsgType = âMpâ) was sent, the reply session shall be 4177 If a reply message with confirmation (MsgType = âMqâ) was sent, the timeout timer of the reply 4179 If a request message (MsgType âMrâ) is received with a different sequence counter for an 4181 If a request message (MsgType âMrâ) is received for an already open reply session and the 4186 If a confirmation message (MsgType âMcâ) is received for an open reply session with the 4188 If a confirmation message (MsgType âMcâ) is received without having an open reply session with 4190 If the timeout timer of a reply session expires, the reply session shall be closed. In case of a 4192 The topography counter values obtained in an MD.addListener service primitive shall be used 4195 If a TRDP user receives a request message with topography counter values different to the 4198 If a TRDP user removes or updates a listener (e.g. after a train topology change) during an 4200 The behavior of the replierâs TRDP layer is depicted in Figure A.23 with explanations given in 4203 4205 IEC CD 61375-2-3 © IEC 2024 - 176 - 9/3102/CD 4206",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Figure A.23 â TRDP layer MD replier state chart": "4207",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Table A.26 â MD replier state diagram â triggers": "4208 **Triggers Description** MD.addListener User called MD.addListener service primitive replyTimeout) _IEC_ [msgType == âMrâ] [exists == TRUE] /filterForListener [exists == FALSE ] Start (mdHandleRequest) [msgType == âMrâ AND / mdIndicate(data) [exists == FALSE] [exists == TRUE ] StateWaitForApplReply [replyType == âMpâ] [replyType == âMqâ] entry / indicate(data) MD.reply / leave StateWaitForConfirm / openReplySession mcReceived / indicate(data); leave timeout / leave exit / release (data OR timeout OR abort) Start (mdReplySession) CompositeStateReplier MD.addListener / addListener Start (replier) [state == StateWaitForConfirm] [else] [repeated == TRUE] / discardMsg [mdAbort == TRUE] [else] [else] IEC CD 61375-2-3 © IEC 2024 - 177 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Table A.27 â MD replier state diagram â guards": "4210 **Guards Description** existsReplySession The reply session for a given session id exists existsListener A listener for the given request with fitting topography counters replyType Type of MD reply telegram as requested by the user in the stateReplySession(sessionId) replier session state for a given session id protocol type, length and topography counter (at least one of the checkTopoCounts Check the topopology counters of the received message against 4211",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Table A.28 â MD replier state diagram â actions": "4212 **Actions Description** mdReplySession Handles the states of a reply session. confirmation message by invoking MD.indicate service primitive invoking MD.release service primitive mdAbort = FALSE mdAbort = TRUE mdAbort = TRUE the case if the sequence counter of the previous received request discardMsg Discard the received message service primitive) Param = âdataâ: sendReplyErr(replyStatus) Send error reply message IEC CD 61375-2-3 © IEC 2024 - 178 - 9/3102/CD **Actions Description** â Reply type: âMeâ 4213",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Table A.29 â MD replier state diagram â states": "4214 **States Description** CompositeStateReplier Composite state of the replier requesting a reply to the application and is now waiting for the StateWaitForConfirm State of a reply session that has sent out a reply requesting a",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> A.7.8.3 Handling of received messages (action mdHandleReceived)": "4215 The state diagram shown in Figure A.24 with explanations given in Table A.30 until Table A.33 4216 4218",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Figure A.24 â TRDP Layer MD telegram reception": "4219 _IEC_ CompositeStateReceiver mdMessageReceived / mdHandleReceived [exists == TRUE] Start (mdHandleReceived) [msgType == âMpâ] Start / checkMsgHeader [msgType == âMqâ] [msgType == âMcâ] [msgType == âMnâ] [msgType == âMrâ] [msgType == âMrâ] [ else] / discardMsg [else] [else] [else] [else] [else] [else] [OK] [else] / discardMsg [else] / discardMsg [else] [msgType == âMeâ] [exists == TRUE] IEC CD 61375-2-3 © IEC 2024 - 179 - 9/3102/CD",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Table A.30 â MD receiver state diagram â triggers": "4220 **Triggers Description** mdMessageReceived A MD telegram has been received 4221",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Table A.31 â MD receiver state diagram â guards": "4222 **Guards Description** msgType Message telegram type as defined in Table A.18 4223",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Table A.32 â MD receiver state diagram â actions": "4224 **Actions Description** checkCallSession Check if a caller session to the given reply exists If a caller session exists, check that at least one of the cases listed in checkReplySession Check if a reply session to the given request or confirmation exists checkMsgHeader Check the MD telegram header for FCS, version and sequence counter mpReceived Trigger reception of Mnâ type MD telegram 4225",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.8 MD protocol state machine -> Table A.33 â MD receiver state diagram â states": "4226 **States Description** CompositeStateReceiver Composite state of the receiver 4227",
  "Train Real-Time Data Protocol (TRDP) -> A.7 Message Data -> A.7.9 TCP Connection Handling": "4228 This subclause defines the handling of TCP connections for TRDP message data transmission. 4229 Using TCP for data transmission requires an established TCP connection between the caller 4230 As long as a TCP connection to another device in the required direction is open, it should be 4233 The caller shall close an existing TCP connection (active end) in the following cases: 4235 â¢ A signal that the TCP connection will be closed has been received. 4236 The replier shall use the connection opened by the caller. 4239 IEC CD 61375-2-3 © IEC 2024 - 180 - 9/3102/CD â¢ A signal that the TCP connection will be closed has been received. 4241 is not used anymore for a defined time. 4244",
  "Train Real-Time Data Protocol (TRDP) -> A.8 Message data echo server (option)": "4245 End devices with TRDP message data support can provide a message data echo function. A 4246 The Message Data Echo should be implemented in the TRDP layer. 4251 When message data arrive with the echo ComId (see Table A.2) an echo message is created 4252 4255"
}